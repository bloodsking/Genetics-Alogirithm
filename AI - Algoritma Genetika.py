# -*- coding: utf-8 -*-
"""Final AI.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1r4DDOa_yxJjmsgVMf-HeC6AZ3bFw93Ig

TUGAS BESAR AI : ALGORITMA GENETIK
(1301204125) Ryan Chandra Hadi
(1301200240) Ramadhan Aditya Ibrahim
"""

import numpy as np
import pandas as pd
import math

# minimum dan maksimum value yang ada di dalam fungsi
min = -5
max = 5

# menyatakan banyaknya variabel, panjang dari kromosom itu sendiri (x,y)
m = 2

# menyatakan banyaknya populasi 
n = 100

# pc = 1
# pm = interval -0.1 s.d 0.1

# maksimum generasi
N = 20

def createPopulations(): # fungsi ini dibuat untuk meng-generate populasi
    populasi = np.random.rand(n, m)*(max - min)+ min
    pop = pd.DataFrame(populasi)
    pop.columns = ['x', 'y']
    
    return pop

"""![minimasi.png](data:image/png;base64,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)"""

def fitness(pop): 
    h = (np.cos(pop['x']) + np.sin(pop['y']))**2 / ((pop['x'])**2 + (pop['y'])**2) # rumus untuk mencari nilai h(x, y)
    fitness = 1 / h + 1
    pop['Fitness'] = fitness
    pop['Nilai Fungsi'] = h
    
    return pop

def randomSelection(): # fungsi untuk meng-generate indeks random 
    position = np.random.permutation(n)
    
    return position[0], position[1]

def crossover(pop): # fungsi ini untuk melakukan pindah silang yang sudah 
                    # dilakukan seleksi orang tua dengan menggunakan metode fungsi randomSelection
    popCrossover = pop.copy()
    for i in range(n):
        a, b = randomSelection()
        x = (pop.loc[a] + pop.loc[b])/2
        popCrossover.loc[i] = x
        
    return popCrossover

def mutasi(popCrossover): # fungsi ini kita pakai untuk membuat mutasi pada populasi 
                          # yang telah kita lakukan crossover
    popMutasi = popCrossover.copy()

    for i in range(n):
        for j in popMutasi.columns:
            popMutasi.loc[i][j] += np.random.uniform(low=-0.1, high=0.1)

    return popMutasi

def combinePop(pop, popCrossover, popMutasi): # Menggabungkan nilai populasi awal,
                                              # setelah crossover dan setelah mutasi
    popAll = pop.copy()
    popAll = popAll.append(popCrossover)
    popAll = popAll.append(popMutasi)

    popAll.index = range(len(popAll))
    
    return popAll

def sort(popAll): # mengurutkan nilai values berdasarkan fitness secara descending
    popAll = popAll.sort_values(by=['Fitness'], ascending = False)
    popAll.index = range(len(popAll))

    return popAll

def eliminasi(popAll):  # setelah kita lakukan sort, kita lakukan eliminasi sebanyak n = 100
    pop = popAll.head(n)
    
    return pop

pop = createPopulations()
pop

pop = fitness(pop)
pop

popCrossover = crossover(pop)
print(popCrossover)

popCrossover = fitness(popCrossover)
popCrossover

popMutasi = mutasi(popCrossover)

popMutasi

popMutasi = fitness(popMutasi)

popMutasi

popAll = combinePop(pop, popCrossover, popMutasi)
popAll

popAll = sort(popAll)
popAll

pop = createPopulations()
pop = fitness(pop)
print("Generasi Pertama")
print(pop)

for i in range(N):
    popCrossover = crossover(pop)
    popCrossover = fitness(popCrossover)
    
    popMutasi = mutasi(popCrossover)
    popMutasi = fitness(popMutasi)
    
    popAll = combinePop(pop, popCrossover, popMutasi)
    
    popAll = sort(popAll)
    pop = eliminasi(popAll)
    print()
    print(i)
    print(pop)

print()
print("Generasi Terakhir")
print(pop)



